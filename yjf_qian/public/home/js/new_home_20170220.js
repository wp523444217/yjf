function showPay(e,t){payLayer[e]?payLayer[e].show(!0):$.getScript("http://a.dwstatic.com/huya/icenter/2.5/js/createLayer.js",function(){var o=Math.floor(1e10*Math.random());payLayer[e]=new Createlayer({title:"充值",width:670,height:450,url:"http://hd.huya.com/pay/index.html?source=icenter"+(t?"&panelType="+t:""),idDom:"topUpPaymentLayer_"+o,idMask:"topUpPaymentLayerMask_"+o})})}function bindEvents(){$(".third_nick_sync").on("click",function(){var e={url:indexUrl+"index.php?m=Home&do=ajaxSetThirdNick",success:function(e){e&&e.status&&200==e.status&&window.location.reload()},errorFn:function(){window.console||console.log("昵称同步失败")}};getAjax(e)})}function getAjax(e){$.ajax({url:e.url,dataType:"jsonp",data:e.data,success:function(t){e.success(t)},error:function(){e.errorFn()}})}document.domain="huya.com",$(document).ready(function(){function e(e){return 9999>=e?e:e>9999&&99999999>=e?t(e/1e4)+"万":t(e/1e8)+"亿"}function t(e){if(e=""+e,-1==e.indexOf("."))return e;var t=e.split(".");return t[0]+"."+t[1].charAt(0)}location.href.match("evt=recharge")&&$("#jdRechargeBtn").click();var o=null;$("#fileImg").uploadify({buttonText:"上传图片",fileSizeLimit:"1MB",width:120,height:120,fileObjName:"avatar",fileTypeDesc:"Image Files",fileTypeExts:"*.gif; *.jpg; *.png;*.jpeg",swf:"base/uploadify/uploadify.swf",uploader:"index.php?m=Captcha&do=saveImg",onUploadError:function(e,t,o,a){alert("The file "+e.name+" could not be uploaded: "+a)},onUploadStart:function(){window.console&&console.log("上传开始")},onUploadSuccess:function(e,t,a){if(window.console&&console.log("上传成功"),a){var n=$.parseJSON(t),i=n.img;o=n.file,$("#header_photo,#preview").attr("src",i);{setTimeout(function(){var e=new Image;e.onload=function(){var t=e.width>300?331:e.height+30;$("#img_width").val(e.width),$("#img_height").val(e.height),$(".cut_left").height(t),start(),$("img#header_photo").imgAreaSelect({x1:0,y1:0,x2:100,y2:100}),$(".imgareaselect-outer").css({position:"absolute"}).show(),$(".imgareaselect-selection").parent().css({position:"absolute"}).show();var o,a,n;if(e.width<=640){var i=e.width<=300?e.width:300;$("img#header_photo").imgAreaSelect({x1:0,y1:0,x2:i,y2:i}),o=e.width-100,a=e.height-100,n=e.height,$(".imgareaselect-outer").eq(2).css({left:$(".imgareaselect-selection").width()}),$(".imgareaselect-outer").eq(3).css({width:i,height:$("#aaaa").height()-i,top:i}),$("#preview").css({width:100,height:"auto",marginLeft:0,marginTop:0}),e.width<=e.height?($('input[name="x1"]').val(0),$('input[name="y1"]').val(0),$('input[name="x2"]').val(e.width),$('input[name="y2"]').val(e.width)):($('input[name="x1"]').val(0),$('input[name="y1"]').val(0),$('input[name="x2"]').val(e.height),$('input[name="y2"]').val(e.height))}else{var s=parseInt(640/(e.width/300));e.height<640&&(s=parseInt(640/(e.height/300))),s>$("#aaaa").height()&&(s=$("#aaaa").height()),$("img#header_photo").imgAreaSelect({x1:0,y1:0,x2:s,y2:s});var c=e.width/300,r=100/(s*c),d=Math.round(r*e.width)+"px";$("#preview").css({width:d,height:"auto",marginLeft:0,marginTop:0}),$('input[name="x1"]').val(0),$('input[name="y1"]').val(0),$('input[name="x2"]').val(e.width/300*s),$('input[name="y2"]').val(e.width/300*s)}},e.src=$("#header_photo")[0].src},100)}$(".bg,#the_img").show()}}}),$("#fileImg").on("mouseover",function(){$(".img_hover").show()}),$("#fileImg").on("mouseout",function(){$(".img_hover").hide()});var a;$("#img_submit").on("change","#fileImg",function(){a=$(this).clone(!0)}),$(".sure_img").on("click",function(){var e=parseInt($("#x1").val()),t=parseInt($("#y1").val()),a=parseInt($("#x2").val()),n=parseInt($("#y2").val());$.ajax({url:indexUrl+"index.php?m=ProfileSetting&do=updateAvatar",data:{avatar_id:o,xywh:e+","+t+","+(a-e)+","+(n-t)}}).done(function(e){if(e=$.parseJSON(e),e.status){if(505==e.status)return $("#the_img,.bg").hide(),void $("#check_accesstoken").show();location.reload()}else alert(e.msg)}).fail(function(e){alert("上传出错"+e.toString())})}),$("#the_img .close,.quit_img").on("click",function(){$(".imgareaselect-outer").hide(),$(".imgareaselect-selection").parent().hide()}),user&&1===user&&$.getJSON(indexUrl+"?do=ajaxUd",{},function(e){""!=e.n&&$(".uesr_n").text(e.n),""!=e.y&&$("#YY").text(e.y)}),""!==loginType&&$(".change_n").hide(),$("#check_accesstoken").on("click","#check_loggout",function(){NAV_UTIL.logout()}),$("#check_accesstoken").on("click",".btn-close",function(){$("#check_accesstoken").hide()}),$("#grow_level").on("mouseover",".contact",function(){$(".grow_msg").show()}),$("#grow_level").on("mouseout",".contact",function(){$(".grow_msg").hide()}),$(".tool-info .num").each(function(){var t=parseInt($(this).text());$(this).text(e(t)).removeClass("hidden")}),$(".tool-info").on("mouseover",function(){$(this).find(".tool_msg").removeClass("hidden")}),$(".tool-info").on("mouseout",function(){$(this).find(".tool_msg").addClass("hidden")}),$("#account_num").on("mouseover",".account_num_list",function(){$(this).addClass("hover")}),$("#account_num").on("mouseout",".account_num_list",function(){$(this).removeClass("hover")}),$.ajax({type:"get",url:"http://l.huya.com/udb_web/udbport2.php?do=isBindMobile",data:"",success:function(e){if(200==e.status&&e.data){var t=e.data;t.isBind&&($("#no_phone").addClass("hidden"),$(".mobile").text(t.bindMobile),$("#phone").removeClass("hidden"))}},dataType:"jsonp"}),$("#bindMobile,#changeMobile").on("click",function(){var e=$(this).attr("data-is-thirduser");1==e?$.ajax({type:"get",url:"http://l.huya.com/udb_web/udbport2.php?do=getUdbthirdPhoneBindURL",success:function(e){if(200==e.status&&e.data){var t=e.data;$("#popThirdBind").show(),$("#bindIframe iframe").attr("src",t.bindURL+"&callback_url="+encodeURIComponent("http://hd.huya.com/thirdBlank/index.html"))}},dataType:"jsonp"}):0==e&&$(this).attr("href","https://aq.yy.com/mb/mob/index.do")}),$("#grow_greener,#grow_recommend").on("click",".get_task",function(){var e=$(this).attr("task-id"),t=$(this).attr("data-exper");$.ajax({url:"http://q.huya.com/yy/index.php?m=User&do=doGetTaskPrize",dataType:"jsonp",data:{taskId:e},success:function(e){if(200==e.status){var o=e.data.code;0==o&&($("#exper").text(t),$(".bg").show(),$("#getTask").show()),910==o&&alert("奖励已领"),913==o&&alert("任务已下线"),914==o&&alert("任务未完成")}else alert(e.msg)},error:function(){alert("访问出错！")}})}),$("#getTask").on("click",".btn-close,.btn",function(){window.location.reload()}),$("#closeThirdPop").on("click",function(){$("#popThirdBind").hide()}),$(".close,.quit_fans,.quit_img,.quit_hide_sh").on("click",function(){$(".bg,.fans_box,.fans_del,.bind,#the_img,.hide_sh").hide(),data_bid=null,$(".bind iframe")&&$(".bind iframe").remove()}),$("#the_img .box_top").css({cursor:"move"}),$("#the_img .box_top").draggable($("#the_img")),bindEvents()});var goldbeanExpiryDateBox=LEGO.popupBox("#goldbean_expiry_date_box",{ok:function(){goldbeanExpiryDateBox.close()},cancle:function(){goldbeanExpiryDateBox.close()},existMask:!0}),bindSuccessCallback=function(){$("#popThirdBind").hide(),location.reload()};window.BindSuccessCallback=bindSuccessCallback;var payLayer=[];$("#jdRechargeBtn").click(function(){showPay(0)}),$("#ydRechargeBtn").click(function(){showPay(1,"yd")}),$.fn.extend({draggable:function(e){var t,o,a,n,i=$(void 0==$(e)?this:e);$(this).mousedown(function(e){t=e.pageX,o=e.pageY,a=i.position().left,n=i.position().top,$(document).mousemove(function(e){var s=parseInt(e.pageX)-parseInt(t)+parseInt(a),c=parseInt(e.pageY)-parseInt(o)+parseInt(n);i.css({left:s,top:c})}).mouseup(function(){$(document).unbind("mousemove")}).mouseleave(function(){$(document).unbind("mousemove")})})}});